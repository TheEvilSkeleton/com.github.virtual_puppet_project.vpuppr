id: com.github.virtual_puppet_project.vpuppr
runtime: org.freedesktop.Platform
runtime-version: "22.08beta"
sdk: org.freedesktop.Sdk
command: vpuppr.x86_64
finish-args:
    - "--socket=x11"
    - "--share=ipc"
    - "--share=network" # Required for communication between openseeface and vpuppr
    - "--device=all" # webcam
    - "--socket=pulseaudio"
    - "--filesystem=home" # to see all files (vpuppr uses its own file picker), and function to select models properly
modules:

  # --- Puppeteer ---
  - name: puppeteer
    buildsystem: simple
    build-commands:
      - mkdir -p /app/bin/
      - install -Dm644 com.github.virtual_puppet_project.vpuppr.metainfo.xml -t /app/share/metainfo/
      - rm com.github.virtual_puppet_project.vpuppr.metainfo.xml
      
      - install -Dm 644 -t /app/share/applications com.github.virtual_puppet_project.vpuppr.desktop
      - install -Dm 644 com.github.virtual_puppet_project.vpuppr-128.png /app/share/icons/hicolor/128x128/apps/com.github.virtual_puppet_project.vpuppr.png
      - install -Dm 644 com.github.virtual_puppet_project.vpuppr-256.png /app/share/icons/hicolor/256x256/apps/com.github.virtual_puppet_project.vpuppr.png
      - rm com.github.virtual_puppet_project.vpuppr-{128,256}.png

      - mv * /app/bin/
      - chmod +x /app/bin/vpuppr.x86_64
      - chmod +x /app/bin/resources/extensions/open_see_face/OpenSeeFaceFolder/OpenSeeFace/facetracker
#      - mv /app/bin/gui /app/bin/licenses /app/bin/scripts /app/bin/translations /app/bin/resources/
#      - mv /app/bin/OpenSeeFace /app/bin/OpenSeeFaceFolder/

    sources:
      - type: archive
<<<<<<< HEAD
        url: https://github.com/virtual-puppet-project/vpuppr/releases/download/0.9.0-alpha-2/vpuppr_0.9.0-alpha-2_linux_flatpak_compatible.zip
        sha256: 2cf553526eeb05491364d363a9add8996d3f2537fe7b58d6ff2086974c31dab4
=======
        url: https://github.com/virtual-puppet-project/vpuppr/releases/download/0.9.0-alpha/vpuppr_0.9.0-alpha_linux_flatpak_compatible.zip
        sha256: 19a5594311c4bf5bb8f16246b63b39f250bc3e000ae8003726cc5038270b465f
>>>>>>> ff32d09ad4d376bbd4ee476dd239573f9514c567
      - type: file
        path: com.github.virtual_puppet_project.vpuppr.desktop
      - type: file
        path: icons/com.github.virtual_puppet_project.vpuppr-128.png
      - type: file
        path: icons/com.github.virtual_puppet_project.vpuppr-256.png
      - type: file
        path: com.github.virtual_puppet_project.vpuppr.metainfo.xml
