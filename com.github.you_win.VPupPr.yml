id: com.github.you_win.VPupPr
runtime: org.freedesktop.Platform
runtime-version: "21.08"
sdk: org.freedesktop.Sdk
command: OpenSeeFaceGD.x86_64
finish-args:
    - "--socket=x11"
    - "--share=ipc"
    - "--share=network" # to set up the deps for openseeface
    - "--device=all"
    - "--socket=pulseaudio"
    - "--filesystem=home:ro"
modules:

  # --- Puppeteer ---
  - name: puppeteer
    buildsystem: simple
    build-commands:
      - mkdir -p /app/bin/{resources,OpenSeeFaceFolder}
      - install -Dm 644 -t /app/share/applications com.github.you_win.VPupPr.desktop
      - |
        for icon in 16 24 32 48 64 128 256; do
          install -Dm 644 com.github.you_win.VPupPr-$icon.png /app/share/icons/hicolor/${icon}x${icon}/apps/com.github.you_win.VPupPr.png
          mkdir -p /app/share/icons/${icon}x${icon}/apps/
        done

      - mv * /app/bin/
      - mv /app/bin/gui /app/bin/licenses /app/bin/scripts /app/bin/translations /app/bin/resources/
      - mv /app/bin/OpenSeeFace /app/bin/OpenSeeFaceFolder/

    sources:
      - type: archive
        url: https://github.com/virtual-puppet-project/vpuppr/releases/download/0.8.1/openseeface-gd_0.8.1_linux.zip
        sha256: 31932f233a496054a3305033406e6f3fa2b14dc54e0d2fda3895349980714735
      - type: file
        path: com.github.you_win.VPupPr.desktop
      - type: file
        path: icons/com.github.you_win.VPupPr-16.png
      - type: file
        path: icons/com.github.you_win.VPupPr-24.png
      - type: file
        path: icons/com.github.you_win.VPupPr-32.png
      - type: file
        path: icons/com.github.you_win.VPupPr-48.png
      - type: file
        path: icons/com.github.you_win.VPupPr-64.png
      - type: file
        path: icons/com.github.you_win.VPupPr-128.png
      - type: file
        path: icons/com.github.you_win.VPupPr-256.png